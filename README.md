## ContentKit-Editor [![Build Status](https://travis-ci.org/bustlelabs/content-kit-editor.svg?branch=master)](https://travis-ci.org/bustlelabs/content-kit-editor)

ContentKit is a modern WYSIWYG editor supporting interactive cards. Try a
demo at [http://content-kit.herokuapp.com/](http://content-kit.herokuapp.com/).

ContentKit articles (we will use the term article, but any kind of content could
be authored) are built from models. Models represent rows of content, and can
be static or dynamic.

For example, the teardown of an article might look like:
**FIXME** this needs to be updated:

```
┌──────────────────────────────────────────────────────────────────────────────┐
│                                 ┌──────────┐                                 │
│                                 │ Article  │                                 │
│                                 └──────────┘                                 │
│┌────────────────────────────────────────────────────────────────────────────┐│
││                              ┌──────────────┐                              ││
││                              │ MarkupModel  │                              ││
││                              └──────────────┘                              ││
││ <h2>One Weird Trick</h2>                                                   ││
│└────────────────────────────────────────────────────────────────────────────┘│
│┌────────────────────────────────────────────────────────────────────────────┐│
││                              ┌──────────────┐                              ││
││                              │  BlockModel  │                              ││
││                              └──────────────┘                              ││
││ <p>                                                                        ││
││   You will never guess what <i>happens</i>                                 ││
││   when these cats take a <b>bath</b>                                       ││
││ </p>                                                                       ││
│└────────────────────────────────────────────────────────────────────────────┘│
│┌────────────────────────────────────────────────────────────────────────────┐│
││                              ┌──────────────┐                              ││
││                              │  EmbedModel  │                              ││
││                              └──────────────┘                              ││
││ <img src="http://some-cdn.com/uploaded.jpg" />                             ││
││ <!-- this HTML is generated by the embed API endpoint at edit-time -->     ││
│└────────────────────────────────────────────────────────────────────────────┘│
│┌────────────────────────────────────────────────────────────────────────────┐│
││                         ┌────────────────────────┐                         ││
││                         │ BlockModel (type CARD) │                         ││
││                         └────────────────────────┘                         ││
││ node.innerHTML = 'Cards can change content at render time. For example,    ││
││ use an Ember component';                                                   ││
│└────────────────────────────────────────────────────────────────────────────┘│
└──────────────────────────────────────────────────────────────────────────────┘
```

### Usage

ContentKit is attached to a DOM node when the `Editor` factory is instantiated.

```js
var editor = new ContentKit.Editor(this.element, options);
```

`options` is an object which may include the following properties:

* `stickyToolbar` - a boolean option enabling a persistent header with
  formatting tools. Default is true for touch devices.
* `placeholder` - default text to show before a user starts typing.
* `spellcheck` - a boolean option enabling spellcheck. Default is true.
* `autofocus` - a boolean option for grabbing input focus when an editor is
  rendered.
* `serverHost` - a URL prefix for embed and image API request. **[FIXME Remove]**
* `cards` - an object describing available cards.

### Public Editor API

* `editor.loadPost(post)` - render the editor with a post. **[FIXME Implement]**
* `editor.serializePost()` - serialize the current post for persistence. **[FIXME Implement]**

### Deploy the demo website

The demo website is hosted at github pages.
To publish a new version do:

  * `npm run build-website`. This builds the website into `website/` and commits it
  * `npm run deploy-website`. Pushes the `website/` subtree to the `gh-pages` branch at github

Visit [http://bustlelabs.github.io/content-kit-editor/demo](http://bustlelabs.github.io/content-kit-editor/demo).

### Contributing

Running ContentKit tests and demo server locally requires the following dependencies:

* [node.js](http://nodejs.org/) ([install package](http://nodejs.org/download/)) or `brew install node`
* `broccoli`, via `npm install -g broccoli-cli`

### Tests

Install npm and bower:

  * `bower i i`
  * `npm i`

Run tests via the built-in broccoli server:

  * `npm run serve`
  * `open http://localhost:4200/tests`

Or run tests via testem:

  * `npm test`

To view the demo:

  * `broccoli serve`
  * open http://localhost:4200/demo
  * (Note that image uploads and embeds are not currently working)

#### To Do

Bring back image uploads and embed. Notes below:

For uploads and embeds to work, you will have to configure AWS and
Embedly keys as environment variables:

```bash
export AWS_ACCESS_KEY_ID=XXXXXX
export AWS_SECRET_ACCESS_KEY=XXXXXX
export EMBEDLY_KEY=XXXXXX
```

Also, set the `bucketName` in `server/config.json` with the name of your AWS
S3 bucket for uploading files.

Then to boot the server:

```
node server/index.js
```

And visit http://localhost:5000/dist/demo/index.html
